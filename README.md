# generator-sails-polymer

This is a generator for the Sails server part of a Polymer application.

Install latest version of `yo` CLI

`npm install --g yo`

## Install generator
- *npm* `npm install -g generator-sails-polymer2`
- *yarn* `yarn global add generator-sails-polymer2`
- *github* `npm install -g git+https://git@github.com/kristianmandrup/generator-sails-polymer.git`

Alternatively clone and `npm link`

Invoke the new generator via `yo` command

>yo sails-polymer2

The generator will take you through the rest of the process.

Project file structure

```
/config - Sails configuration files
/elements - Polymer elements used in views
/public - Static assets (css etc.)
/swagger - Swagger UI files
/test - Mocha Tests
app.js - starts Sails server
bower.json - includes client/view dependencies
Gruntfile.js - Grunt tasks
http.js - Swagger middleware config for Express
package.json - Server (and task) dependencies
swaggerindex.html - Swagger UI entry point
bowerrc - bower configuration
ediforconfig - editor configuration
gitignore - files patterns to ignore
jshintrc - jshint configuration
```

### Swagger UI

The project is configured with [Swagger UI](http://swagger.io/swagger-ui/) to document the Sails REST API. The Swagger configuration can be found in `config/http.js`. Currently it uses an old version of swagger express.
Feel free to upgrade and use a more modern middleware (and make a PR)

### SPA

The Sails project is an SPA which contains a single root `/` view route which renders `views/index.html`. It must be made to contain all the javascript and other assets necessary for the client.

The view renders an element `<my-app>` which can be found under `/elements`.

The Polymer project is loosely based on the project generated by the Polymer starter kit.

## Sails configuration
Sails is configured in the `/config` folder

*Connections*

The `connections.js` is for Waterline ORM configurations.
See list of [available adapters](http://sailsjs.com/documentation/concepts/extending-sails/adapters/available-adapters)

By default the following adapters are used:
- [sails-disk](https://www.npmjs.com/package/sails-disk)
- [sails-mongo](https://www.npmjs.com/package/sails-mongo)

```
  mongo: {
    adapter: 'sails-mongo',
    url: 'mongodb://your-mongo-db'
  }
```

*Models*

```
module.exports.models = {

  // Change to 'mongo' if you want to switch to MongoDb
  connection: 'localDiskDb'
};
```

*Routes*

```
'/': { view: 'index' }
```

*Http middleware*

`bowerrc` is configured to use `public/bower_components` for installation.
This ensures you can reference bower files in your views.

`index.html` uses the polyfill `webcomponents-lite` when web components are not supported natively by your browser

`script.src = '/bower_components/webcomponentsjs/webcomponents-lite.min.js';`

### Recommendations
The included SPA view `/` route and view `index.html` file is mainly for demonstration/test purposes.

We recommend that for larger projects, you develop the Polymer project on its own as a separate project and that the Sails server is API only, including:
- REST routes
- web sockets
- GraphQL
- ...

## Polymer client app
- [Polymer 2.0 overview](https://www.polymer-project.org/1.0/blog/2016-09-09-polymer-2.0)
- [Element availability](https://www.polymer-project.org/2.0/docs/about_20#polymer-element-availability)

### Getting started
- [Installation](https://www.polymer-project.org/2.0/docs/about_20#installing)
- [Polymer starter kit](https://developers.google.com/web/tools/polymer-starter-kit/)

Install the Polymer CLI
`npm install -g polymer-cli`

The CLI comes with some basic project templates to get started

Example: Initialize project from `starter-kit` template 

```
mkdir my-app
cd my-app
polymer init starter-kit
```

### Advanced
- [Build a Polymer 2.0 Carousel](https://codelabs.developers.google.com/codelabs/polymer-2-carousel/#0)

## Development
See [Yo Getting started](http://yeoman.io/authoring/index.html) for basic Yeoman generator development instructions

Yo uses [File edition helpers](https://github.com/sboudrias/mem-fs-editor) for file operations such as templating

Use `npm link` to create symbolic link and register generator with yeoman. Then run `yo sails-polymer2` to use your local development version.

## FAQ
A common problem when running this generator is the lack of a 'basePath' field for the swagger-express module.

If you receive the error:

```
./node_modules/swagger-express/lib/swagger-express/index.js:228
throw new Error('\'basePath\' is required.');
```

then before execution of line 265 (but in the body of the exports.init function) set `ops.basePath = '.';` and the app should lift smoothly.






